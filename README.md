# Reprocess Excel file into a Matrix


Excel file that has multiple tables within a single excel sheet (most likely generated by some sort of legacy analytics system) 
the requirement was to "melt" the individual tables, set column names and then create a large matrix.


The way I approched this was to create a grouper column along the index where "Year" appeeared at the start of each table.

The unique name for each "case" appeared two rows prior to Year - so the Year column is key. 

After creating a key,value pair dataframe I then apply a set of operations to clean and re-shape the dataframe.

A custom sort was required for the ValueType column so I used pd.Categorical here. 

column names were parsed for each table by splitting by a new line return. The unit measurement always appeared last so slicing
the last element worked well here.

I also added a raw/processed & unprocessed folder for audit purposes

a curated folder with a timestamp with the output.

and a basic logger to catch basic errors.
